#### 进入保护模式

****

##### 1、全局描述符表

**段描述符：**

- 和一个段有关的信息需要8字节来描述，所以称为段描述符。
- 在内存中开辟出一段空间，集中存放段的描述符，构成了一个描述符表。
- 每个段都需要一个段描述符

**全局描述符表寄存器(GDTR)：**

图例：全局描述符表寄存器

![](.\imgs\24-全局描述符表寄存器.png)

- 处理器内部有一个48位的寄存器（即全局描述符表寄存器），用于跟踪全局描述符表。
- 高32位保存的是起始线性地址，对于32位处理器，拥有32根地址线，可访问的内存范围是`0x00000000`~`0xFFFFFFFF`，共4GB内存。
- 低16位保存的是全局描述符表的界限，也就是表的大小(总字节数)减1

**全局描述符表的大小：**

- 全局描述符表的第一个字节偏移量是0，最后1字节的偏移量是表大小减1

- 由于GDT的界限是16位的，所以该表最大为64KB(2^16=65536字节/1024)，注意GDT是按字节为单位的
- 一个描述符占8个字节，因此最多定义8192的描述符。

**表的存放位置：**

![](.\imgs\25-全局描述符表的存放位置.png)

- 全局描述符表必须在进入保护模式前定义，因为进入保护模式之后，处理器要立即按照新的内存访问模式工作。
- 由于实模式下只能访问1MB的内存，所以GDT通常都定义在1MB以下的内存范围中。可以在进入保护模式之后换个位置重新定义GDT。
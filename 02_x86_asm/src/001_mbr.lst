     1                                  ; 简单的主引导扇区(MBR)示例
     2                                  ; 编译命令: nasm -f bin mbr.asm -o mbr.bin
     3                                  
     4                                  org 0x7C00                  ; BIOS将MBR加载到0x7C00处
     5                                  
     6                                  start:
     7                                      ; 初始化段寄存器
     8 00000000 31C0                        xor ax, ax
     9 00000002 8ED8                        mov ds, ax
    10 00000004 8EC0                        mov es, ax
    11 00000006 8ED0                        mov ss, ax
    12 00000008 BC007C                      mov sp, 0x7C00          ; 设置堆栈指针
    13                                  
    14                                      ; 清屏
    15 0000000B B80006                      mov ax, 0x0600          ; AH=06(滚动), AL=00(全窗口)
    16 0000000E B707                        mov bh, 0x07            ; 属性(黑底白字)
    17 00000010 B90000                      mov cx, 0x0000          ; 左上角(0,0)
    18 00000013 BA4F18                      mov dx, 0x184F          ; 右下角(24,79)
    19 00000016 CD10                        int 0x10
    20                                  
    21                                      ; 设置光标位置
    22 00000018 B402                        mov ah, 0x02            ; AH=02(设置光标)
    23 0000001A B700                        mov bh, 0x00            ; 页号0
    24 0000001C BA0000                      mov dx, 0x0000          ; DH=行, DL=列
    25 0000001F CD10                        int 0x10
    26                                  
    27                                      ; 显示消息
    28 00000021 BE[3700]                    mov si, msg
    29 00000024 E80200                      call print_string
    30                                  
    31                                      ; 无限循环
    32 00000027 EBFE                        jmp $
    33                                  
    34                                  ; 打印字符串函数
    35                                  ; 输入: SI=字符串地址
    36                                  print_string:
    37 00000029 AC                          lodsb                   ; 加载AL中的下一个字符
    38 0000002A 08C0                        or al, al               ; AL=0?
    39 0000002C 7408                        jz .done                ; 如果是，则完成
    40 0000002E B40E                        mov ah, 0x0E            ; BIOS tele-type输出
    41 00000030 B700                        mov bh, 0x00            ; 页号0
    42 00000032 CD10                        int 0x10
    43 00000034 EBF3                        jmp print_string
    44                                  .done:
    45 00000036 C3                          ret
    46                                  
    47                                  ; 数据
    48 00000037 48656C6C6F2066726F-     msg db "Hello from MBR!", 0x0D, 0x0A, 0
    48 00000040 6D204D4252210D0A00 
    49                                  
    50                                  ; 填充剩余空间并添加引导签名
    51 00000049 00<rep 1B5h>            times 510-($-$$) db 0
    52 000001FE 55AA                    dw 0xAA55                   ; 引导扇区签名
